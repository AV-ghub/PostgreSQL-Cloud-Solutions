# CockroachDB
## Как мы мигрировали критичную БД с Oracle в CockroachDB
> https://habr.com/ru/companies/qiwi/articles/669208/

### Основные моменты

CockroachDB — PostgreSQL-совместимая (по SQL-синтаксису DML) распределенная СУБД с открытым кодом (ну, почти). 
Ее название символизирует, что она, как таракан, выживает в любых экстремальных ситуациях. 

СУБД с привычным SQL-интерфейсом, настройка которой занимает 5 минут, которая 
- хранит данные — как Kafka — на нескольких узлах в нескольких ЦОДах сразу
- имеет настраиваемый replication factor на уровне конкретных таблиц
- легко переживает потерю как одного узла, так и целого ЦОДа
- использует для этого механизм распределенного консенсуса Raft
- имеет строгую консистентность и уровень изоляции serializable.

Среди распределенных SQL-СУБД есть альтернативы в виде 
- Yugabyte
- TiDB
- YDB

Вопрос «Почему?» связан в первую очередь с тем, _**зачем вообще нужна БД**_
- надежно хранить данные
- доставать их через стандартный язык SQL, а удобство ее использования — приятный, но вторичный фактор

_**Ключевыми критериями выбора**_ были:

- многократно проверенный движок хранения данных. В CockroachDB используется RocksDB, в остальных — неизвестно кем, как и сколько тестированные альтернативы;
- регулярное тестирование тестом Jepsen в рамках сборки релиза на наличие проблем безопасного хранения данных в распределенной БД. CockroachDB успешно прошли этот этап еще 5 лет назад;
- совместимость с PostgreSQL для того, чтобы быстро мигрировать туда в случае серьезных проблем. TiDB совместимо с MySQL, YugaByte с Postgres, YDB пока что ни с чем;
- простота настройки, отсутствие сложных decoupled-архитектур. Тут CockroachDB лидер: один бинарный файл, один конфигурационный файл, все изменения проходят либо в онлайне, либо с поочередной перезагрузкой узлов кластера.

 
