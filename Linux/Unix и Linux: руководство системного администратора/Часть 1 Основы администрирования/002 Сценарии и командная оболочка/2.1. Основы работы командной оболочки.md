Редактирование команд
Все основные команды редактора emacs доступны при редактировании уже выполненного ряда команд (т.е. “предыстории”). Нажав комбинацию клавиш **<Ctrl+E>**, вы переместитесь в конец строки, а с помощью комбинации клавиш **<Ctrt+A>** — в начало. Нажатие комбинации клавиш <Ctrl+P> позволяет вернуться к предыдущим командам и вызвать их для редактирования. С помощью комбинации клавиш **<Ctrl+R>** вы сможете шаг за шагом “прокрутить” свою “предысторию” и найти старые команды.

Если вы предпочитаете использовать редактор vi, переключите свою командную
оболочку в **режим vi**.
```
$ set -о vi
```
В режиме vi редактирование является модальным, но вы начинаете работать в режиме ввода команд. Для того чтобы выйти из режима ввода, нажмите вначале клавишу **<Esc>**, а затем клавишу **<i>**, чтобы вернуться в него. В режиме редактирования нажатие клавиши <w> переместит вас вперед на одно слово; использование комбинаций72 Часть I. Основы администрирования клавиш **<f+X>** позволит найти следующий символ “X” в строке и т.д. “Прогуляться” по командам, зафиксированным в “предыстории”, можно с помощью клавиш <Esc> и <к>.

Решили вернуться в **режим emacs**-редактирования? Выполните эту команду.
```
$ set -о emacs
```

## Каналы и перенаправление потоков
Для систем UNIX используется унифицированная модель ввода-вывода, в которой каждому каналу присваивается целое число, именуемое файловым дескриптором. Точное
число (номер), назначаемое каналу, обычно не имеет значения, но каналам STDIN, STDOUT и STDERR гарантированно соответствуют файловые дескрипторы 0, 1 и 2 соответственно, чтобы обеспечить безопасное обращение к ним по номерам. В контексте интерактивного окна терминала канал STDIN обычно считывает данные с клавиатуры, а оба канала STDOUT и STDERR записывают свои выходные данные на экран.

Командная оболочка интерпретирует символы “<”, “>” и “>>” как инструкции по изменению направления передаваемых командой данных в файл или принимаемых данных из файла. Символ “<” связывает канал STDIN с содержимым некоторого существующего файла. Символы “>” и “>>” перенаправляют поток STDOUT; причем символ “>” используется для замены содержимого файла, а “>>” — для добавления данных в его конец. Например, команда
```
$ echo "Это тестовое сообщение." > /tmp/mymessage
```
сохраняет одну строку в файле /tmp/mymessage (при необходимости файл будет создан). Следующая команда отправляет содержимое этого файла по электронной почте пользователю johndoe.
```
$ mail -s "Mail test" johndoe < /tmp/mymessage
```
Для того чтобы перенаправить потоки STDOUT и STDERR в одно и то же место, используйте символ **“>&”**. Для того чтобы перенаправить только поток STDERR, используйте вариант **“2>”**.

Чтобы **отбросить все сообщения об ошибках**, можно использовать такой вариант.
```
$ find / -name core 2> /dev/null
```

Для того чтобы последующая **команда выполнялась только в случае успешного выполнения предыдущей**, можно разделить эти команды символом **&&** Например, командная строка
```
$ lpr /tmp/t2 && rm /tmp/t2
```
удалит файл /tmp/t2 тогда и только тогда, когда она успешно дождется очереди на печать.

И наоборот, символ “**||**” обеспечит **выполнение следующей команды только в том случае, если предыдущая команда не выполнится** (т.е. сгенерирует ненулевое значение кода завершения).

Для того чтобы разбить команду на несколько строк, для наглядности отделяя тем самым код обработки ошибок от остальной части командного конвейера, можно использовать в сценариях обратную косую черту.
```
ср --preserve --recursive /etc/* /spare/backup \
|| echo "Did NOT make backup"
```
Для получения обратного эффекта, т.е. **объединения нескольких команд в одной строке, можно использовать в качестве разделителя точку с запятой**

## Использование переменных и кавычек
В операциях присваивания имена переменных никак не маркируются, но предваряются знаком доллара при ссылке на их значения.
```
$ etcdir='/etc'
$ echo $etcdir
```
**Не ставьте до и после знака равенства (=) пробелы**, в противном случае оболочка ошибочно примет имя вашей переменной за имя команды.

При ссылке на переменную можно заключить ее имя в фигурные скобки, чтобы синтаксический анализатор (да и сам человек) не сомневался в том, где заканчивается имя переменной и начинается другой текст

Часто нужно сделать так, чтобы после значения переменной стояли буквы
или знаки препинания.
```
$ echo "Saved ${rev}th version of mdadm.conf."
Saved 8th version of mdadm.conf.
```

**Переменные среды** автоматически импортируются в **пространство имен оболочки** bash, поэтому их можно устанавливать и считывать с использованием стандартного синтаксиса. 

Для того чтобы **перевести переменную оболочки в ранг переменной среды**, используйте команду 
```
export имя_переменной
```
Команды для переменных среды, которые вы хотите установить во время регистрации (при входе в систему), должны быть включены в ваш файл **~/.profile** или **~/.bash_profile**. Другие переменные среды, такие как PWD (для хранения имени текущего рабочего каталога), автоматически создаются командной оболочкой.





